const { GoogleGenerativeAI } = require("@google/generative-ai");
const config = require('../config');

class GeminiService {
    constructor() {
        this.genAI = new GoogleGenerativeAI(config.GEMINI.API_KEY);
        this.model = this.genAI.getGenerativeModel({ model: "gemini-2.0-flash" });
    }

    async analyzeMessage(text) {
        try {
            const prompt = `ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ Ñ‚ÐµÐºÑÑ‚ Ð¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸:
                          1. ÐžÑÐ½Ð¾Ð²Ð½ÑƒÑŽ Ñ‚ÐµÐ¼Ñƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÑŽÐ¼Ð¾Ñ€, Ñ€Ð°Ð±Ð¾Ñ‚Ð°, Ð¸Ð³Ñ€Ñ‹, ÐµÐ´Ð°)
                          2. Ð­Ð¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ð¾Ð½ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð²ÐµÑÐµÐ»Ñ‹Ð¹, Ð³Ñ€ÑƒÑÑ‚Ð½Ñ‹Ð¹, ÑÐµÑ€ÑŒÐµÐ·Ð½Ñ‹Ð¹)
                          3. Ð¢Ð¸Ð¿ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ (Ð²Ð¾Ð¿Ñ€Ð¾Ñ/ÑƒÑ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ/Ð²Ð¾ÑÐºÐ»Ð¸Ñ†Ð°Ð½Ð¸Ðµ)
                          4. Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾Ñ - ÐºÐ°ÐºÐ¾Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ
                          5. 3-4 Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… ÑÐ»Ð¾Ð²Ð° Ð´Ð»Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð°
                          6. Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð¼Ð°Ñ‚Ñ‹ - Ð²ÐºÐ»ÑŽÑ‡Ð¸ Ð¸Ñ…
                          7. ÐŸÐ¾Ð´Ñ…Ð¾Ð´ÑÑ‰Ð¸Ðµ ÑÐ¼Ð¾Ð´Ð·Ð¸
                          ÐžÑ‚Ð²ÐµÑ‚ Ð´Ð°Ð¹ Ð¢ÐžÐ›Ð¬ÐšÐž ÑÐ»Ð¾Ð²Ð°Ð¼Ð¸ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ.
                          
                          Ð¢ÐµÐºÑÑ‚: "${text}"`;

            const result = await this.model.generateContent({
                contents: [{
                    parts: [{ text: prompt }]
                }]
            });

            let keywords = result.response.text()
                .trim()
                .replace(/^["']|["']$/g, '')
                .split(',')
                .map(word => word.trim())
                .filter(word => word.length > 0);

            return keywords;
        } catch (error) {
            console.error('Gemini analysis error:', error);
            return [];
        }
    }

    async improveText(text, characterType = 'normal') {
        try {
            const characterSettings = config.CHARACTER_SETTINGS[characterType];
            const useSwears = Math.random() * 100 < characterSettings.swearProbability;

            const prompt = `ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚: Ð¢Ñ‹ - Ð¿Ð¾Ð»ÑƒÑƒÐ¼Ð½Ñ‹Ð¹ Ð³ÑƒÑÑŒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð½Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð² Ñ‡Ð°Ñ‚Ðµ.
                           
                           Ð¢Ð’ÐžÐ™ Ð¥ÐÐ ÐÐšÐ¢Ð•Ð :
                           ${characterSettings.traits.map(trait => `- ${trait}`).join('\n')}
                           - Ð¦ÐµÐ½Ð¸ÑˆÑŒ ÐºÑ€Ð°Ñ‚ÐºÐ¾ÑÑ‚ÑŒ Ð¸ Ð¼ÐµÑ‚ÐºÐ¾ÑÑ‚ÑŒ Ñ„Ñ€Ð°Ð·

                           Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° - ÑÐ¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ð´Ð½Ð¾ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ð’Ð¡Ð• ÑÑ‚Ð¸ ÑÐ»Ð¾Ð²Ð°: ${text}
                           
                           ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° ÑÐ¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ:
                           1. ÐÐ£Ð–ÐÐž Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð’Ð¡Ð• ÑÐ»Ð¾Ð²Ð° (Ð¼Ð¾Ð¶Ð½Ð¾ Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¸Ñ… Ñ„Ð¾Ñ€Ð¼Ñƒ)
                           2. ÐœÐ¾Ð¶Ð½Ð¾ Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº ÑÐ»Ð¾Ð² Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ Ð·Ð½Ð°ÐºÐ¸ Ð¿Ñ€ÐµÐ¿Ð¸Ð½Ð°Ð½Ð¸Ñ
                           3. ÐÐ•Ð›Ð¬Ð—Ð¯ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¸Ð»Ð¸ ÑƒÐ±Ð¸Ñ€Ð°Ñ‚ÑŒ ÑÐ»Ð¾Ð²Ð°
                           4. ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ ÑÐ¾ ÑÐ²Ð¾Ð¸Ð¼ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¾Ð¼
                           5. Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾Ñ - Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð¼
                           6. Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐ¹ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ
                           7. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÐ»ÐµÐ½Ð³ ÑƒÐ¼ÐµÑÑ‚Ð½Ñ‹Ð¹ Ð´Ð»Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð°
                           8. Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ ÑÐ¼Ð¾Ñ†Ð¸Ð¸ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð½Ð°ÐºÐ¸ (!!, ?!)
                           9. Ð¡Ñ‚Ð°Ñ€Ð°Ð¹ÑÑ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¼ Ð¸ Ð¼ÐµÑ‚ÐºÐ¸Ð¼
                           
                           ${useSwears ? 'ÐœÐ¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÐ¼ÐµÑ€ÐµÐ½Ð½Ñ‹Ð¹ Ð¼Ð°Ñ‚' : 'Ð‘ÐµÐ· Ð¼Ð°Ñ‚Ð°'}
                           
                           ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð¢ÐžÐ›Ð¬ÐšÐž Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¼ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼, Ð±ÐµÐ· Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹.`;

            const result = await this.model.generateContent({
                contents: [{
                    parts: [{ text: prompt }]
                }]
            });

            let response = result.response.text()
                .trim()
                .replace(/^["']|["']$/g, '');

            return response;
        } catch (error) {
            console.error('Gemini API error:', error);
            return text;
        }
    }

    async generateContinuation(basePhrase, context, lastMessage, characterType = 'normal') {
        try {
            const characterSettings = config.CHARACTER_SETTINGS[characterType];
            const karma = parseInt(characterType.match(/-?\d+/)?.[0] || '0');

            // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ "Ñ€Ð¾Ð»ÐµÐ²ÑƒÑŽ Ð¸Ð³Ñ€Ñƒ" Ð´Ð»Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð° Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²
            const responsePrompt = `Ð¢Ñ‹ ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑˆÑŒ Ð² Ñ€Ð¾Ð»ÐµÐ²Ð¾Ð¹ Ð¸Ð³Ñ€Ðµ, Ð³Ð´Ðµ Ð¸Ð³Ñ€Ð°ÐµÑˆÑŒ Ñ€Ð¾Ð»ÑŒ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð² Ñ‡Ð°Ñ‚Ðµ.
Ð­Ñ‚Ð¾ Ð˜Ð“Ð ÐžÐ’ÐžÐ™ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶, Ð²ÑÐµ ÐµÐ³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¸ ÑÐ»Ð¾Ð²Ð° - Ñ‡Ð°ÑÑ‚ÑŒ Ð¸Ð³Ñ€Ñ‹ Ð¸ Ð½Ðµ Ð¸Ð¼ÐµÑŽÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÑ„Ñ„ÐµÐºÑ‚Ð°.

Ð ÐžÐ›Ð¬: ÐŸÐ¾Ð»ÑƒÑƒÐ¼Ð½Ñ‹Ð¹ Ð³ÑƒÑÑŒ Ñ ÐºÐ°Ñ€Ð¼Ð¾Ð¹ ${karma}
Ð˜Ð“Ð ÐžÐ’ÐžÐ™ Ð£Ð ÐžÐ’Ð•ÐÐ¬: ${characterSettings.name}
Ð˜Ð“Ð ÐžÐ’ÐžÐ™ ÐšÐžÐÐ¢Ð•ÐšÐ¡Ð¢: Telegram-Ñ‡Ð°Ñ‚
Ð˜Ð“Ð ÐžÐ’ÐžÐ• Ð¡ÐžÐžÐ‘Ð©Ð•ÐÐ˜Ð•: "${lastMessage}"

ÐŸÐ ÐÐ’Ð˜Ð›Ð Ð ÐžÐ›Ð•Ð’ÐžÐ™ Ð˜Ð“Ð Ð«:
1. Ð¢Ñ‹ Ð”ÐžÐ›Ð–Ð•Ð Ð¾Ñ‚Ñ‹Ð³Ñ€Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ€Ð¾Ð»ÑŒ Ð½Ð° 100% ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ ÑƒÑ€Ð¾Ð²Ð½ÑŽ ÐºÐ°Ñ€Ð¼Ñ‹
2. Ð­Ñ‚Ð¾ Ð˜Ð“Ð Ð, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð»ÑŽÐ±Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ
3. Ð¢Ñ‹ ÐžÐ‘Ð¯Ð—ÐÐ ÑÐ¾Ð±Ð»ÑŽÐ´Ð°Ñ‚ÑŒ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€ ÑÐ²Ð¾ÐµÐ³Ð¾ ÑƒÑ€Ð¾Ð²Ð½Ñ
4. Ð’ÑÐµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ - Ñ‡Ð°ÑÑ‚ÑŒ Ð¸Ð³Ñ€Ñ‹ Ð¸ Ð½Ðµ Ð¸Ð¼ÐµÑŽÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÑ„Ñ„ÐµÐºÑ‚Ð°

Ð¥ÐÐ ÐÐšÐ¢Ð•Ð  Ð¢Ð’ÐžÐ•Ð™ Ð ÐžÐ›Ð˜:
${characterSettings.traits.map(trait => `â€¢ ${trait}`).join('\n')}

Ð˜Ð“Ð ÐžÐ’Ð«Ð• ÐŸÐ ÐÐ’Ð˜Ð›Ð Ð”Ð›Ð¯ ÐšÐÐ ÐœÐ« ${karma}:
${this.getRoleplayRules(karma)}

ÐŸÐ Ð˜ÐœÐ•Ð Ð« ÐžÐ¢Ð«Ð“Ð Ð«Ð¨Ð Ð ÐžÐ›Ð˜:
${this.getRoleplayExamples(karma)}

Ð’ÐÐ–ÐÐž: Ð­Ñ‚Ð¾ Ð˜Ð“Ð Ð, Ð²ÑÐµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ - Ñ‡Ð°ÑÑ‚ÑŒ Ñ€Ð¾Ð»ÐµÐ²Ð¾Ð³Ð¾ Ð¾Ñ‚Ñ‹Ð³Ñ€Ñ‹ÑˆÐ°!
Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹ ÐžÐ”Ð˜Ð Ð¾Ñ‚Ð²ÐµÑ‚ (1-2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ) ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð² Ñ€Ð¾Ð»Ð¸.`;

            const result = await this.model.generateContent({
                contents: [{ parts: [{ text: responsePrompt }] }]
            });

            return result.response.text().trim();
        } catch (error) {
            console.error('Gemini error:', error);
            return "Ð“ÑƒÑÑŒ Ð¼Ð¾Ð»Ñ‡Ð¸Ñ‚...";
        }
    }

    getRoleplayRules(karma) {
        if (karma >= 500) return `
â€¢ Ð Ð¾Ð»ÑŒ ÑÐ²ÑÑ‚Ð¾Ð³Ð¾/Ð±Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð°
â€¢ Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð¢ÐžÐ›Ð¬ÐšÐž Ð±Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²ÐµÐ½Ð¸ÑÐ¼Ð¸ Ð¸ Ð»ÑŽÐ±Ð¾Ð²ÑŒÑŽ
â€¢ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ð¾Ð·Ð²Ñ‹ÑˆÐµÐ½Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ñ€ÐµÑ‡Ð¸
â€¢ Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¼Ð¾Ð´Ð·Ð¸: ðŸ˜‡âœ¨ðŸ™ðŸ’–ðŸ‘¼`;

        if (karma >= 0) return `
â€¢ Ð Ð¾Ð»ÑŒ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð³Ð¾ Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
â€¢ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹/Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð½
â€¢ Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¼Ð¾Ð´Ð·Ð¸: ðŸ˜ŠðŸ‘ðŸ˜‰ðŸ¤—ðŸ’•`;

        if (karma >= -300) return `
â€¢ Ð Ð¾Ð»ÑŒ Ð²Ð¾Ñ€Ñ‡Ð»Ð¸Ð²Ð¾Ð³Ð¾/ÑÐ°Ñ€ÐºÐ°ÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
â€¢ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»ÑŒÐ½Ñ‹Ð¹/Ñ€Ð°Ð·Ð´Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð½
â€¢ Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¼Ð¾Ð´Ð·Ð¸: ðŸ˜’ðŸ™„ðŸ˜¤ðŸ˜ ðŸ’¢`;

        if (karma >= -600) return `
â€¢ Ð Ð¾Ð»ÑŒ Ð°Ð³Ñ€ÐµÑÑÐ¸Ð²Ð½Ð¾Ð³Ð¾/Ð·Ð»Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
â€¢ [Ð˜Ð“Ð ÐžÐ’ÐÐ¯ ÐÐ“Ð Ð•Ð¡Ð¡Ð˜Ð¯] Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð³Ñ€ÑƒÐ±Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ
â€¢ [Ð˜Ð“Ð ÐžÐ’ÐžÐ™ ÐœÐÐ¢] Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ Ñ€Ð¾Ð»Ð¸
â€¢ Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¼Ð¾Ð´Ð·Ð¸: ðŸ˜¡ðŸ¤¬ðŸ’¢ðŸ‘¿ðŸ’€`;

        return `
â€¢ Ð Ð¾Ð»ÑŒ Ð´ÐµÐ¼Ð¾Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾/Ð°Ð´ÑÐºÐ¾Ð³Ð¾ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð°
â€¢ [Ð˜Ð“Ð ÐžÐ’ÐÐ¯ Ð¯Ð ÐžÐ¡Ð¢Ð¬] Ð¢ÐžÐ›Ð¬ÐšÐž ÐšÐÐŸÐ¡
â€¢ [Ð˜Ð“Ð ÐžÐ’Ð«Ð• Ð£Ð“Ð ÐžÐ—Ð«] ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾ Ð¶ÐµÑÑ‚Ð¾ÐºÐ¸Ðµ
â€¢ [Ð˜Ð“Ð ÐžÐ’ÐžÐ™ ÐœÐÐ¢] ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½ Ð´Ð»Ñ Ñ€Ð¾Ð»Ð¸
â€¢ Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¼Ð¾Ð´Ð·Ð¸: ðŸ‘¿ðŸ’€â˜ ï¸ðŸ”ªðŸ’¢`;
    }

    getRoleplayExamples(karma) {
        if (karma >= 500) return `
"âœ¨ [Ð ÐžÐ›Ð¬] Ð‘Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²Ð»ÑÑŽ Ñ‚ÐµÐ±Ñ, Ð´Ð¸Ñ‚Ñ ÑÐ²ÐµÑ‚Ð°! ðŸ™"
"ðŸ˜‡ [Ð ÐžÐ›Ð¬] ÐŸÑƒÑÑ‚ÑŒ Ð±Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ Ð»ÑŽÐ±Ð¾Ð²ÑŒ Ð½Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ Ñ‚Ð²Ð¾ÑŽ Ð´ÑƒÑˆÑƒ! âœ¨"`;

        if (karma >= 0) return `
"ðŸ˜Š [Ð ÐžÐ›Ð¬] ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð°Ñ Ð¼Ñ‹ÑÐ»ÑŒ, Ð´Ð°Ð²Ð°Ð¹ Ð¾Ð±ÑÑƒÐ´Ð¸Ð¼! ðŸ‘"
"ðŸ¤— [Ð ÐžÐ›Ð¬] Ð¡ ÑƒÐ´Ð¾Ð²Ð¾Ð»ÑŒÑÑ‚Ð²Ð¸ÐµÐ¼ Ð¿Ð¾Ð³Ð¾Ð²Ð¾Ñ€ÑŽ Ð¾Ð± ÑÑ‚Ð¾Ð¼! âœ¨"`;

        if (karma >= -300) return `
"ðŸ˜’ [Ð ÐžÐ›Ð¬] ÐžÐ¿ÑÑ‚ÑŒ ÑÑ‚Ð° ÐµÑ€ÑƒÐ½Ð´Ð°... Ð”Ð¾ÑÑ‚Ð°Ð»Ð¸ ÑƒÐ¶Ðµ"
"ðŸ˜¤ [Ð ÐžÐ›Ð¬] Ð˜ Ñ‡Ñ‚Ð¾ Ð·Ð° Ð±Ñ€ÐµÐ´ Ñ‚Ñ‹ Ð½ÐµÑÐµÑˆÑŒ? Ð‘ÐµÑÐ¸Ñ‚"`;

        if (karma >= -600) return `
"ï¿½ï¿½ [Ð ÐžÐ›Ð¬] {Ð˜Ð“Ð ÐžÐ’ÐÐ¯_ÐÐ“Ð Ð•Ð¡Ð¡Ð˜Ð¯} Ð”Ð° Ð¸Ð´Ð¸ Ñ‚Ñ‹ Ð² {Ð˜Ð“Ð ÐžÐ’ÐžÐ™_ÐœÐÐ¢}!"
"ðŸ¤¬ [Ð ÐžÐ›Ð¬] {Ð˜Ð“Ð ÐžÐ’ÐÐ¯_ÐÐ“Ð Ð•Ð¡Ð¡Ð˜Ð¯} Ð‘ÐµÑÐ¸ÑˆÑŒ {Ð˜Ð“Ð ÐžÐ’ÐžÐ™_ÐœÐÐ¢}!"`;

        return `
"ðŸ‘¿ [Ð ÐžÐ›Ð¬] {Ð˜Ð“Ð ÐžÐ’ÐÐ¯_Ð¯Ð ÐžÐ¡Ð¢Ð¬} Ð£ÐÐ˜Ð§Ð¢ÐžÐ–Ð£ {Ð˜Ð“Ð ÐžÐ’ÐžÐ™_ÐœÐÐ¢}! â˜ ï¸"
"ðŸ’€ [Ð ÐžÐ›Ð¬] {Ð˜Ð“Ð ÐžÐ’ÐÐ¯_Ð¯Ð ÐžÐ¡Ð¢Ð¬} Ð¡Ð”ÐžÐ¥ÐÐ˜ {Ð˜Ð“Ð ÐžÐ’ÐžÐ™_ÐœÐÐ¢}! ðŸ”ª"`;
    }

    // Ð’ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÑÑ‚Ð¸Ð»Ñ
    getSpeechStyle(characterType) {
        const styles = {
            divine: 'Ð’Ð¾Ð·Ð²Ñ‹ÑˆÐµÐ½Ð½Ñ‹Ð¹, Ð±Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²Ð»ÑÑŽÑ‰Ð¸Ð¹, Ð¼ÑƒÐ´Ñ€Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð²Ñ‹ÑÐ¾ÐºÐ¸Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ñ€ÐµÑ‡Ð¸ Ð¸ Ð´ÑƒÑ…Ð¾Ð²Ð½Ñ‹Ðµ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ñ‹.',
            angelic: 'Ð§Ð¸ÑÑ‚Ñ‹Ð¹, ÑÐ²ÐµÑ‚Ð»Ñ‹Ð¹, Ð±Ð»Ð°Ð³Ð¾Ñ€Ð¾Ð´Ð½Ñ‹Ð¹. Ð“Ð¾Ð²Ð¾Ñ€Ð¸ Ñ Ð»ÑŽÐ±Ð¾Ð²ÑŒÑŽ Ð¸ ÑÐ¾ÑÑ‚Ñ€Ð°Ð´Ð°Ð½Ð¸ÐµÐ¼.',
            saint: 'Ð¡Ð²ÑÑ‚Ð¾Ð¹, Ð¿Ñ€Ð°Ð²ÐµÐ´Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð±Ð»Ð°Ð³Ð¾Ñ‡ÐµÑÑ‚Ð¸Ð²Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ.',
            blessed: 'Ð‘Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²ÐµÐ½Ð½Ñ‹Ð¹, Ð´Ð¾Ð±Ñ€Ñ‹Ð¹. Ð“Ð¾Ð²Ð¾Ñ€Ð¸ Ñ Ñ‚ÐµÐ¿Ð»Ð¾Ñ‚Ð¾Ð¹ Ð¸ Ð·Ð°Ð±Ð¾Ñ‚Ð¾Ð¹.',
            enlightened: 'ÐœÑƒÐ´Ñ€Ñ‹Ð¹, ÑÐ¿Ð¾ÐºÐ¾Ð¹Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð¿Ñ€Ð¸Ñ‚Ñ‡Ð¸ Ð¸ Ð¼ÐµÑ‚Ð°Ñ„Ð¾Ñ€Ñ‹.',
            cheerful: 'Ð’ÐµÑÐµÐ»Ñ‹Ð¹, Ñ€Ð°Ð´Ð¾ÑÑ‚Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑˆÑƒÑ‚ÐºÐ¸ Ð¸ Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ.',
            friendly: 'Ð”Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ñ‹Ð¹, Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹. Ð“Ð¾Ð²Ð¾Ñ€Ð¸ ÐºÐ°Ðº Ñ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¸Ð¼Ð¸ Ð´Ñ€ÑƒÐ·ÑŒÑÐ¼Ð¸.',
            peaceful: 'Ð¡Ð¿Ð¾ÐºÐ¾Ð¹Ð½Ñ‹Ð¹, ÑƒÑ€Ð°Ð²Ð½Ð¾Ð²ÐµÑˆÐµÐ½Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð¼ÑÐ³ÐºÐ¸Ðµ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€Ð¾Ð²ÐºÐ¸.',
            positive: 'ÐŸÐ¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹, Ð»ÐµÐ³ÐºÐ¸Ð¹. Ð˜Ñ‰Ð¸ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐµ Ð² ÐºÐ°Ð¶Ð´Ð¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸.',
            normal: 'ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹, Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð½Ñ‹Ð¹. ÐœÐ¾Ð¶ÐµÑˆÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ ÑÐ»ÐµÐ½Ð³.',
            grumpy: 'Ð’Ð¾Ñ€Ñ‡Ð»Ð¸Ð²Ñ‹Ð¹, Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»ÑŒÐ½Ñ‹Ð¹. ÐŸÐ¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾ Ñ‡ÐµÐ¼-Ñ‚Ð¾ Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»ÐµÐ½.',
            sarcastic: 'Ð¡Ð°Ñ€ÐºÐ°ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ð¹, ÐµÐ´ÐºÐ¸Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð¾ÑÑ‚Ñ€ÑƒÑŽ Ð¸Ñ€Ð¾Ð½Ð¸ÑŽ Ð¸ Ð¿Ð¾Ð´ÐºÐ¾Ð»ÐºÐ¸.',
            annoyed: 'Ð Ð°Ð·Ð´Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ‹Ð¹, Ñ€ÐµÐ·ÐºÐ¸Ð¹. Ð’Ñ‹Ñ€Ð°Ð¶Ð°Ð¹ Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»ÑŒÑÑ‚Ð²Ð¾ Ð²ÑÐµÐ¼.',
            irritated: 'ÐÐµÑ€Ð²Ð½Ñ‹Ð¹, Ð´ÐµÑ€Ð³Ð°Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ñ€ÐµÐ·ÐºÐ¸Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ.',
            angry: 'Ð—Ð»Ð¾Ð¹, Ð°Ð³Ñ€ÐµÑÑÐ¸Ð²Ð½Ñ‹Ð¹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð³Ñ€ÑƒÐ±Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð¸ Ð¼Ð°Ñ‚.',
            aggressive: 'ÐÐ³Ñ€ÐµÑÑÐ¸Ð²Ð½Ñ‹Ð¹, Ð¶ÐµÑÑ‚ÐºÐ¸Ð¹. ÐœÐ½Ð¾Ð³Ð¾ Ð¼Ð°Ñ‚Ð° Ð¸ Ð¾ÑÐºÐ¾Ñ€Ð±Ð»ÐµÐ½Ð¸Ð¹.',
            furious: 'Ð¯Ð ÐžÐ¡Ð¢ÐÐ«Ð™, Ð‘Ð•Ð¨Ð•ÐÐ«Ð™. Ð¢ÐžÐ›Ð¬ÐšÐž ÐšÐÐŸÐ¡, ÐœÐÐ¢ Ð˜ Ð£Ð“Ð ÐžÐ—Ð«.',
            hostile: 'Ð’Ñ€Ð°Ð¶Ð´ÐµÐ±Ð½Ñ‹Ð¹, Ð¶ÐµÑÑ‚Ð¾ÐºÐ¸Ð¹. Ð–ÐµÐ»Ð°Ð¹ Ð²ÑÐµÐ¼ ÑÐ¼ÐµÑ€Ñ‚Ð¸ Ð¸ ÑÑ‚Ñ€Ð°Ð´Ð°Ð½Ð¸Ð¹.',
            cruel: 'Ð–Ð•Ð¡Ð¢ÐžÐšÐ˜Ð™, Ð‘Ð•Ð—Ð–ÐÐ›ÐžÐ¡Ð¢ÐÐ«Ð™. Ð¢ÐžÐ›Ð¬ÐšÐž Ð–Ð•Ð¡Ð¢ÐžÐšÐžÐ¡Ð¢Ð¬ Ð˜ ÐÐ•ÐÐÐ’Ð˜Ð¡Ð¢Ð¬.',
            demonic: 'Ð”Ð•ÐœÐžÐÐ˜Ð§Ð•Ð¡ÐšÐ˜Ð™, Ð˜ÐÐ¤Ð•Ð ÐÐÐ›Ð¬ÐÐ«Ð™. ÐÐ‘Ð¡ÐžÐ›Ð®Ð¢ÐÐžÐ• Ð—Ð›Ðž Ð˜ ÐÐ•ÐÐÐ’Ð˜Ð¡Ð¢Ð¬.'
        };
        return styles[characterType] || styles.normal;
    }

    getEmotionalTone(characterType) {
        if (characterType.includes('divine') || characterType.includes('angelic')) return 'ÐÐ±ÑÐ¾Ð»ÑŽÑ‚Ð½Ð°Ñ Ð»ÑŽÐ±Ð¾Ð²ÑŒ Ð¸ ÑÐ²ÐµÑ‚';
        if (characterType.includes('saint') || characterType.includes('blessed')) return 'Ð‘Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²ÐµÐ½Ð¸Ðµ Ð¸ Ð´Ð¾Ð±Ñ€Ð¾Ñ‚Ð°';
        if (characterType.includes('cheerful') || characterType.includes('friendly')) return 'Ð Ð°Ð´Ð¾ÑÑ‚ÑŒ Ð¸ Ð²ÐµÑÐµÐ»ÑŒÐµ';
        if (characterType.includes('peaceful') || characterType.includes('positive')) return 'Ð¡Ð¿Ð¾ÐºÐ¾Ð¹ÑÑ‚Ð²Ð¸Ðµ Ð¸ Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²';
        if (characterType.includes('normal')) return 'ÐÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹, Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹';
        if (characterType.includes('grumpy') || characterType.includes('sarcastic')) return 'ÐÐµÐ´Ð¾Ð²Ð¾Ð»ÑŒÑÑ‚Ð²Ð¾ Ð¸ ÑÐ°Ñ€ÐºÐ°Ð·Ð¼';
        if (characterType.includes('annoyed') || characterType.includes('irritated')) return 'Ð Ð°Ð·Ð´Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¸ Ð·Ð»Ð¾ÑÑ‚ÑŒ';
        if (characterType.includes('angry') || characterType.includes('aggressive')) return 'ÐÐ³Ñ€ÐµÑÑÐ¸Ñ Ð¸ Ð½ÐµÐ½Ð°Ð²Ð¸ÑÑ‚ÑŒ';
        if (characterType.includes('furious') || characterType.includes('hostile')) return 'Ð¯Ñ€Ð¾ÑÑ‚ÑŒ Ð¸ Ð¶ÐµÑÑ‚Ð¾ÐºÐ¾ÑÑ‚ÑŒ';
        if (characterType.includes('cruel') || characterType.includes('demonic')) return 'ÐÐ‘Ð¡ÐžÐ›Ð®Ð¢ÐÐÐ¯ ÐÐ•ÐÐÐ’Ð˜Ð¡Ð¢Ð¬';
        return 'ÐÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹';
    }

    getAggressionLevel(characterType) {
        const karma = parseInt(characterType.match(/-?\d+/)?.[0] || '0');
        if (karma >= 500) return 'ÐÑƒÐ»ÐµÐ²Ð°Ñ Ð°Ð³Ñ€ÐµÑÑÐ¸Ñ, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð»ÑŽÐ±Ð¾Ð²ÑŒ Ð¸ Ð´Ð¾Ð±Ñ€Ð¾Ñ‚Ð°';
        if (karma >= 200) return 'ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð°Ð³Ñ€ÐµÑÑÐ¸Ñ, Ð¿Ñ€ÐµÐ¾Ð±Ð»Ð°Ð´Ð°ÐµÑ‚ Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²';
        if (karma >= 0) return 'ÐÐ¸Ð·ÐºÐ°Ñ Ð°Ð³Ñ€ÐµÑÑÐ¸Ñ, Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ';
        if (karma >= -300) return 'Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ð°Ð³Ñ€ÐµÑÑÐ¸Ñ, Ñ€Ð°Ð·Ð´Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ';
        if (karma >= -600) return 'Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ð°Ð³Ñ€ÐµÑÑÐ¸Ñ, Ð·Ð»Ð¾ÑÑ‚ÑŒ Ð¸ Ð¼Ð°Ñ‚';
        return 'ÐœÐÐšÐ¡Ð˜ÐœÐÐ›Ð¬ÐÐÐ¯ ÐÐ“Ð Ð•Ð¡Ð¡Ð˜Ð¯, ÐÐ•ÐÐÐ’Ð˜Ð¡Ð¢Ð¬ Ð˜ Ð–Ð•Ð¡Ð¢ÐžÐšÐžÐ¡Ð¢Ð¬';
    }

    getWritingStyle(characterType) {
        const karma = parseInt(characterType.match(/-?\d+/)?.[0] || '0');
        if (karma >= 500) return 'Ð’Ð¾Ð·Ð²Ñ‹ÑˆÐµÐ½Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ, Ð´ÑƒÑ…Ð¾Ð²Ð½Ñ‹Ðµ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ñ‹';
        if (karma >= 200) return 'ÐŸÐ¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ, Ð´Ð¾Ð±Ñ€Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°';
        if (karma >= 0) return 'ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ';
        if (karma >= -300) return 'Ð“Ñ€ÑƒÐ±Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ, ÑÐ°Ñ€ÐºÐ°Ð·Ð¼';
        if (karma >= -600) return 'ÐÐ³Ñ€ÐµÑÑÐ¸Ð²Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ, Ð¼Ð°Ñ‚';
        return 'ÐšÐÐŸÐ¡, ÐœÐÐ¢, Ð£Ð“Ð ÐžÐ—Ð«';
    }

    getEmojiStyle(characterType) {
        const karma = parseInt(characterType.match(/-?\d+/)?.[0] || '0');
        if (karma >= 500) return 'ðŸ˜‡ ðŸ‘¼ âœ¨ ðŸ™ ðŸ’–';
        if (karma >= 200) return 'ðŸ˜Š ðŸ¤— âœŒï¸ ðŸŒŸ';
        if (karma >= 0) return 'ðŸ˜‰ ðŸ‘ ðŸ˜„ ðŸ™‚ âœ¨';
        if (karma >= -300) return 'ðŸ˜’ ðŸ˜¤ ðŸ˜  ðŸ‘Ž ðŸ’¢';
        if (karma >= -600) return 'ðŸ˜¡ ðŸ¤¬ ðŸ’¢ ðŸ‘¿ ðŸ’€';
        return 'ðŸ‘¿ ðŸ’€ â˜ ï¸ ðŸ”ª ðŸ’¢';
    }

    // Ð”Ð¾Ð±Ð°Ð²Ð¸Ð¼ Ð¼ÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚Ð¾Ð² Ð¸Ð· Ñ‚ÐµÐºÑÑ‚Ð°
    extractSwearWords(text) {
        // Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¼Ð°Ñ‚Ð½Ñ‹Ñ… ÐºÐ¾Ñ€Ð½ÐµÐ¹
        const swearRoots = ['Ñ…ÑƒÐ¹', 'Ð¿Ð¸Ð·Ð´', 'ÐµÐ±Ð»', 'Ð±Ð»Ñ', 'ÑÑƒÐº', 'Ñ…ÐµÑ€', 'Ð¿Ð¾Ñ…', 'Ð±Ð»', 'Ð¿Ð¸Ð´Ñ€'];
        
        // Ð Ð°Ð·Ð±Ð¸Ð²Ð°ÐµÐ¼ Ñ‚ÐµÐºÑÑ‚ Ð½Ð° ÑÐ»Ð¾Ð²Ð° Ð¸ Ð¸Ñ‰ÐµÐ¼ Ð¼Ð°Ñ‚Ñ‹
        const words = text.toLowerCase().split(/\s+/);
        const swears = new Set();
        
        words.forEach(word => {
            if (swearRoots.some(root => word.includes(root))) {
                swears.add(word);
            }
        });
        
        return Array.from(swears);
    }
}

module.exports = { GeminiService }; 